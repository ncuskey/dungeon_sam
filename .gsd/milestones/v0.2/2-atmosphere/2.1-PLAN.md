---
phase: 2-atmosphere
plan: 1
wave: 1
---

# Plan 2.1: Audio Infrastructure

## Objective
Set up the core audio architecture: install Howler.js, create SoundManager singleton, and expose via React hook. This foundation enables all subsequent sound integration.

## Context
- .gsd/SPEC.md
- .gsd/ROADMAP.md  
- src/store/gameStore.ts
- User brief: Deathkeep-style oppressive ambient audio

## Tasks

<task type="auto">
  <name>Install Howler.js</name>
  <files>package.json</files>
  <action>
    Run: npm install howler @types/howler
    
    Howler.js is chosen because:
    - Simplified Web Audio API wrapper
    - Audio sprites support for SFX bundling
    - Automatic format fallbacks
    - Works well with React
  </action>
  <verify>npm ls howler</verify>
  <done>howler and @types/howler appear in dependencies</done>
</task>

<task type="auto">
  <name>Create SoundManager module</name>
  <files>src/audio/SoundManager.ts</files>
  <action>
    Create singleton SoundManager with:
    - Private Howl instances for BGM and SFX
    - Public methods: playBGM(), stopBGM(), playFootstep(), playAttack(), playEnemySound()
    - Volume control properties: masterVolume, musicVolume, sfxVolume
    - Default volumes: SFX at 0.8, Music at 0.4 (SFX louder per Deathkeep style)
    
    DO NOT implement actual sound loading yet - just skeleton with console.log placeholders
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit src/audio/SoundManager.ts</verify>
  <done>SoundManager.ts exists and exports singleton instance</done>
</task>

<task type="auto">
  <name>Create useAudio React hook</name>
  <files>src/hooks/useAudio.ts</files>
  <action>
    Create hook that:
    - Imports soundManager singleton
    - Exposes play functions bound to manager
    - Manages isMuted state with zustand or useState
    - Provides toggleMute() function
  </action>
  <verify>Hook imports cleanly in a test component</verify>
  <done>useAudio hook is usable from React components</done>
</task>

## Success Criteria
- [ ] Howler.js installed as dependency
- [ ] SoundManager.ts compiles without errors
- [ ] useAudio hook can be imported in components
